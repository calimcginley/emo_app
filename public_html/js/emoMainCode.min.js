$(document).on("mobileinit",function(){var a=[];window.localStorage.setItem("profileArray",JSON.stringify(a));console.log(window.localStorage.getItem("profileArray"))});$(document).on("pageshow","#splashPage",function(){setTimeout(function(){endOfSplash()},4000);$("#splashImage").click(function(){endOfSplash()})});var endOfSplash=function(){console.log("Decide which page to show:");if(window.localStorage.getItem("logged")==="Yes"){console.log("localStorage logged value = Yes");$(":mobile-pagecontainer").pagecontainer("change","#mapPage",{transition:"flow"})}else{console.log("No localStorage logged value");$(":mobile-pagecontainer").pagecontainer("change","#loginPage",{transition:"flow"})}};function wipeValueUsername(){document.getElementById("email").setAttribute("value"," ")}function setPasswordInputs(){$("#password-clear").show();$("#password-password").hide();$("#password-clear").focus(function(){$("#password-clear").hide();$("#password-password").show();$("#password-password").focus()});$("#password-password").blur(function(){if($("#password-password").val()===""){$("#password-clear").show();$("#password-password").hide()}});$("#username").blur(function(){if($("#username").val()===""){document.getElementById("username").setAttribute("value","Username")}})}$(document).ready(function(){$(".floatlabel_1").floatlabel()});$(document).ready(function(){$("#loginType").change(function(){var a=$("input[name=radio-loginSignUp]:checked").val();if(a==="signUp"){$("input[name=submitBtn]").val("Sign Up").button("refresh");$("#forgotPass").css("visibility","hidden");$("#fbText").text(" Sign up with Facebook")}else{$("input[name=submitBtn]").val("Login").button("refresh");$("#forgotPass").css("visibility","visible");$("#fbText").text(" Log in with Facebook")}})});$(document).ready(function(){parentOpen=false;$(".emoPostBtn").click(function(b){console.log("Post Btn Clicked");var a=$.mobile.activePage.attr("id");console.log("pageID: "+a);if(a==="mapPage"){$("#"+a).removeClass("show-menu");isOpen=!isOpen;console.log("close menu");c()}else{console.log("Change to map page and open filter");$(":mobile-pagecontainer").pagecontainer("change","#mapPage",{transition:"slide"});c()}function c(){console.log("Open Filter bar");$("#emojiPostSelectParent").velocity({top:"200px",easing:"easein"},10);$("#emojiPostSelectParent").velocity({left:"0",easing:"easein"},500);$("#emojiSearchBar").velocity({top:"-100%",easing:"easein"},500);parentOpen=!parentOpen}});$("#cameraBtn").click(function(a){console.log("Camera CLicked");camera()});$(".emojiParent").on("click",function(){var a=$(this).attr("data-name");console.log(a);window.localStorage.setItem("parentPostEmoji",a);$(":mobile-pagecontainer").pagecontainer("change","#emotionPostPage",{transition:"slidedown"})})});function camera(){navigator.camera.getPicture(a,b,{quality:48,destinationType:Camera.DestinationType.FILE_URI,targetWidth:960,targetHeight:960,saveToPhotoAlbum:true,correctOrientation:false,allowEdit:true});console.log("Camera opened on phone");function a(c){console.log("Camera opened and image was captured");$("#imageHolder").removeClass("cameraMode");$("#imageHolder").addClass("imageMode");var d=document.getElementById("imageHolder");d.src=c;console.log("Image placed into DIV, page change now");console.log(c);window.localStorage.setItem("imageURI",c)}function b(c){console.log("Camera Failed to load"+c)}}$(document).on("click","#postToMapBtn",function(){console.log("Post to map clicked:");var b;var a;var e=function(f){b=f.coords.latitude;a=f.coords.longitude;console.log("postLat is "+b+" and postLong is "+a);d()};function c(f){b=window.localStorage.getItem("setViewLat");a=window.localStorage.setItem("setViewLong");console.log("Geo local fail postLat is "+b+" and postLong is "+a);d()}navigator.geolocation.getCurrentPosition(e,c);function d(){var s=window.localStorage.getItem("userID");var i=window.localStorage.getItem("email");console.log("User Email: "+i);var h=window.localStorage.getItem("parentPostEmoji");console.log("Parent Emoji: "+h);var l=$("#emojiSentDiv").html();console.log("emoji sentence: "+l);var q=$.now();var r=q+"_"+s;console.log("Image Name: "+r);var k="1234";console.log("Music ID: "+k);var p=1;console.log("Public Post: "+p);var f=new Date();var n=f.getMonth()+1;var o=f.getFullYear()+"-"+n+"-"+f.getDate()+" "+f.getHours()+":"+f.getMinutes()+":"+f.getSeconds();console.log("Time on Device: "+o);function j(t){$.mobile.loading("show",{text:"Image uploading ...",textVisible:true});var v=window.localStorage.getItem("imageURI");var u=new FileUploadOptions();u.fileKey="file";u.fileName=t;u.mimeType="image/jpeg";var w={};u.params=w;var x=new FileTransfer();x.upload(v,encodeURI("http://emoapp.info/php/uploadImage.php"),m,g,u)}function m(t){$.mobile.loading("hide");console.log("--- Code has Worked? --- ");console.log("Code = "+t.responseCode);console.log("Response = "+t.response);console.log("Sent = "+t.bytesSent);$(":mobile-pagecontainer").pagecontainer("change","#mapPage",{transition:"slidedown"})}function g(t){$.mobile.loading("hide");alert("An error has occurred: Code = "+t.code);console.log("upload error source "+t.source);console.log("upload error target "+t.target)}j(r);$.ajax({url:"http://emoapp.info/php/postToMap.php",data:{action:"post",userEmail:i,parentEmoji:h,emojiSentence:l,imageLocation:r,musicId:k,postPublic:p,postLat:b,postLong:a,timeDevice:o},type:"post",datatype:"text",async:"true",beforeSend:function(){console.log("Before send ")},complete:function(){console.log("Complete ")},success:function(t){console.log("Database call was : "+t);console.log("Post was inserted to database "+t);console.log("Variables are - Post ID: "+t+" "+b+" "+a+" - Parent: "+h);addMarkerToMap(h,t,b,a);centerMap(b,a)},error:function(u,t){$("#postToMapBtn").html("Post Failed"+t+" "+u.postID+" "+u.status);console.log("Post Failed "+t+" "+u.postID+" "+u.status)}})}});$(document).ready(function(){$(".emojiRender").each(function(a,b){console.log("emoji img code set");$(b).emoji()});window.localStorage.setItem("emojiKeypad","off");$("#toggle").click(function(){$("#panel").slideToggle("fast");var a=window.localStorage.getItem("emojiKeypad");if(a==="off"){console.log("emoji keypad opened");$("#toggle").html("close");$("#insertButtons").velocity({top:"-=100",easing:"easein"},400).delay(800);window.localStorage.setItem("emojiKeypad","on")}else{console.log("emoji keypad closed");$("#toggle").html("emoji Description");$("#insertButtons").velocity({top:"+=100",easing:"easein"},400).delay(800);window.localStorage.setItem("emojiKeypad","off")}})});$(document).on("pagecreate","#emotionPostPage",function(){console.log("set tab selection of emoji");var a=[{":smile:":"smile.png",":blush:":"blush.png",":smiley:":"smiley.png",":relaxed:":"relaxed.png",":smirk:":"smirk.png",":heart_eyes:":"heart_eyes.png",":kissing_heart:":"kissing_heart.png",":kissing_face:":"kissing_face.png",":flushed:":"flushed.png",":relieved:":"relieved.png",":satisfied:":"satisfied.png",":grin:":"grin.png",":wink:":"wink.png",":wink2:":"wink2.png",":tongue:":"tongue.png",":expressionless:":"expressionless.png",":unamused:":"unamused.png",":sweat:":"sweat.png",":pensive:":"pensive.png",":anguished:":"anguished.png",":disappointed:":"disappointed.png"},{":confounded:":"confounded.png",":fearful:":"fearful.png",":cold_sweat:":"cold_sweat.png",":grimacing:":"grimacing.png",":persevere:":"persevere.png",":cry:":"cry.png",":sob:":"sob.png",":joy:":"joy.png",":astonished:":"astonished.png",":scream:":"scream.png",":angry:":"angry.png",":rage:":"rage.png",":sleepy:":"sleepy.png",":sleeping:":"sleeping.png",":eyes:":"eyes.png",":mask:":"mask.png",":imp:":"imp.png",":alien:":"alien.png",":yellow_heart:":"yellow_heart.png",":blue_heart:":"blue_heart.png",":purple_heart:":"purple_heart.png"},{":heart:":"heart.png",":green_heart:":"green_heart.png",":broken_heart:":"broken_heart.png",":cupid:":"cupid.png",":sparkles:":"sparkles.png",":star:":"star.png",":star2:":"star2.png",":anger:":"anger.png",":exclamation:":"exclamation.png",":question:":"question.png",":grey_exclamation:":"grey_exclamation.png",":grey_question:":"grey_question.png",":zzz:":"zzz.png",":dash:":"dash.png",":sweat_drops:":"sweat_drops.png",":notes:":"notes.png",":musical_note:":"musical_note.png",":fire:":"fire.png",":poop:":"poop.png",":thumbUp:":"thumbUp.png",":thumbDown:":"thumbDown.png"},{}];console.log("run thru array and add emoji");for(var b=0;b<4;b++){console.log("This is loop"+b);$.each(a[b],function(e,d){var c="#tab"+b;console.log("added"+e+" emoji"+c);$(c).append('<img class="addEmoji" src="images/emojis/'+d+'" title="'+e+'">')})}});$(document).on("click",".addEmoji",function(){var a=$(this).attr("title");console.log("emoji clicked- Title is = "+a);console.log("emoji img added - now refresh p");$(".emojiRender").append(a);$(".emojiRender").emoji()});$(document).on("click",".removeEmoji",function(){console.log("emoji img removed");$(this).remove()});$(document).on("pageshow","#profilePage",function(c,b){c.preventDefault();var d=JSON.parse(window.localStorage.getItem("profileArray"));if(d.length===0){window.localStorage.setItem("imageCount",7);var a=window.localStorage.getItem("userID");$.ajax({url:"http://emoapp.info/php/getUserPosts.php",data:{userID:a},type:"post",async:"true",dataType:"json",beforeSend:function(){$.mobile.loading("show",{text:"Fetching user Data",textVisible:true})},complete:function(){$.mobile.loading("hide")},success:function(e){console.log("User Posts Fetch successfull");$.each(e.posts,function(f,g){console.log(f+" : "+g.postID);array_push=[f,g.postID,g.imageName,g.timeServer];console.log(array_push);d.push(array_push);window.localStorage.setItem("profileArray",JSON.stringify(d))});insertImageArray(window.localStorage.getItem("imageCount"))},error:function(e){$("#updateBtn").html("There was an error = "+e);console.log("error = "+e);console.log(e);console.log(e.success);console.log("XMLHttpRequest",XMLHttpRequest)}})}});function insertImageArray(a){var b=JSON.parse(window.localStorage.getItem("profileArray"));$("#addHoneyBtn").remove();console.log("start loop imageCount is "+a);console.log("profileImageArray:");console.log(b);console.log(b.length);$.each(b,function(c,d){if(c<=a&&c>=a-7){$(".honeycombs").append('<div class="comb animated fadeIn"><img src="http://www.emoapp.info/uploads/'+d[2]+'.jpg"/><span><b>This is</b><br> a test</span></div>')}});$(".honeycombs").append("");a=parseInt(a)+7;window.localStorage.setItem("imageCount",a);console.log("AfterInsert: imageCount is now "+a);$(".honeycombs").honeycombs();console.log(isPopUpOpen);console.log(isPopUpOpen)}$(document).ready(function(){$("#addHoneyImg").click(function(){console.log("Honey Add Button Clicked");var a=window.localStorage.getItem("imageCount");insertImageArray(a)})});$(document).on("pageshow","#settingsPage",function(){$("#updateBtn").html("Update Info");console.log("Settings page opened");var a=window.localStorage.getItem("email");console.log("Fetch LS email "+a);$.ajax({url:"http://emoapp.info/php/updateInfo2.php",data:{action:"info",userEmail:a},type:"post",async:"true",dataType:"json",beforeSend:function(){$.mobile.loading("show",{text:"",textVisible:true})},complete:function(){$.mobile.loading("hide")},success:function(b){console.log("Info Fetch Succesfull");$("#firstName").val(b.firstName);$("#lastName").val(b.lastName);$("#selectGender").val(b.userGender).selectmenu("refresh")},error:function(c,b){$("#updateBtn").html("There was an error");console.log("error = "+b);console.log("XMLHttpRequest",XMLHttpRequest)}});$("#updateBtn").click(function(){console.log("Update Button Clicked");var d=$("#firstName").val();var b=$("#lastName").val();var e=$("#selectGender").val();var c=window.localStorage.getItem("email");console.log("Fetch LS email"+c);$.ajax({url:"http://emoapp.info/php/updateInfo.php",data:{action:"update",userEmail:c,userFirstName:d,userLastName:b,userGender:e},type:"post",async:"true",dataType:"json",beforeSend:function(){$.mobile.loading("show",{text:"",textVisible:true})},complete:function(){$.mobile.loading("hide")},success:function(){console.log("Update Succesfull");$("#updateBtn").html("Info Updated")},error:function(f){$("#updateBtn").html("There was an error = "+f);console.log("error = "+f);console.log("XMLHttpRequest",XMLHttpRequest)}})})});